# Linux

## 第三章 Linux基础篇 - VM和Linux安装

### 1. 网络连接的三种模式

#### 1. 桥接模式

虚拟系统可以和外部系统相互通信，但是主机数量有限

当主机过多时，ip会产生冲突

#### 2. NAT模式

网络地址转换模式

虚拟机同主机互通，再通过主机进行外部通讯

可以避免ip冲突

#### 3. 仅主机模式

独立系统，不和外部发生联系

### 2. 其他操作

#### 1. 虚拟机迁移和删除

#### 2. 虚拟机克隆

如果需要虚拟机集群时，不需要重新安装虚拟机，只需要进行克隆即可

1. 直接拷贝一份安装好的虚拟机文件，然后修改虚拟机名称和ip地址即可
2. 使用VmWare的虚拟机克隆功能

#### 3. 虚拟机快照

所谓的快照管理，就是将虚拟机恢复到以前的状态

### 3. vmtools

使用 vmtools 来设置共享文件夹

但是在实际开发中，文件的上传和下载需要通过远程环境来完成

## 第四章 Linux目录结构

linux的文件系统，采用层级分明的树状结构，在此结构的最上方是根目录`/`

**Linux中，一切皆文件。**

在Windows中，目录的规定大多时候不是很严格

但是，Linux中，目录的的规定严格很多

Linux中的目录，大多都是规定好的

Linux会把硬件映射成文件进行管理

### Linux目录结构

需要有印象

跟系统相关的文件夹不建议更改

- /bin 常用，这个目录存放着最常用的命令
- /sbin 存放系统管理员的系统管理程序
- /home 常用 存放普通用户的主目录，而Linux中，每个用户都有自己的一个文件夹
- /root 常用 该目录为系统管理员，即root用户的主目录
- /lib 系统开机所需要用到的最基本的动态连接共享库
- /lost + found 一般为空，当系统非法关机后，这里会自动生成文件
- /etc 常用 存放配置文件，如主机名、网络配置、系统参数等
- /usr 常用 存放用户软件，如命令行工具、图形界面工具、文档、帮助文件等
- **/boot** 常用 存放启动时需要的文件，如内核、引导程序等
- /proc 虚拟文件系统，存放系统进程信息，如内存使用情况、网络连接情况、文件系统信息等
- /src 存放一些服务启动之后才需要提取的文件
- /sys Linux2.6内核的一个很大变化，有2.6内核才有的文件系统sysfs
- /tmp 存放临时文件，如shell脚本生成的临时文件等
- /dev 存放设备文件，如键盘、鼠标、打印机、磁盘、网卡等
- /media 存放 removable media，如U盘、光驱等可移动设备
- /mnt 挂载点，用于挂载文件系统，如/dev/hda1挂载到/mnt/hda1中
- /opt 给主机额外安装软件所存放的目录，尽量把些第三方软件安装到这个目录下
- /usr/local 存放用户安装的第三方软件的源码，如apache、mysql、php等
- /var 常用 存放一些动态变化的数据，如日志文件、数据库文件、邮件文件等
- /selinux 保证系统安全，可自行设置

需要记住目录树

## 第五章 Linux实操篇

### 远程登录到Linux

使用 Xshell 进行远程登录

使用 Xftp 进行文件的上传和下载

## 第六章 Vim与Vi

### vi和vim

Linux中，vim和vi是两种不同的编辑器

vi就是记事本

Vim具有程序编辑的能力，是vi的增强版

### 常用的三种模式

- 正常模式：以 vim 打开一个文档时，就进入了正常模式，在这个模式下，可以使用方向键来移动行数，也可以对文档进行删除，或者复制粘贴
- 插入模式：在正常模式下，按下 i 或者 a 或者 o，就可以进入插入模式，在这个模式下，就可以输入内容，并且可以进行删除，复制粘贴等操作
- 命令行模式：在正常模式下，按下 : ，就可以进入命令行模式，在这个模式下，就可以进行一些命令的输入，比如退出 vim，保存文件等

### 各种模式的切换

- 快捷键使用练习：

1. 拷贝当前行 yy， 拷贝当前行向下的 3 行 3yy，然后粘贴到当前行下面 p
2. 删除当前行 dd， 删除当前行向下的 3 行 3dd
3. 在文件中查找某个单词 命令行下 /关键字 ，回车查找， 输入 n 就是查找下一个
4. 设置文件行号，取消文件的行号 :set nu 和 :set nonu
5. 定位到最末行和最受行，G 和 gg
6. 撤销动作 u
7. 光标移动 20行 shift + j

## 第七章 Linux登陆、关机与重启

### 关机

- shutdown -h now 立刻关机
- shutdown -h 10:00 关闭，10点关闭
- shutdown -r now 立刻重启
- shutdown 默认为 -h 1，关机，1表示1分钟后关机
- halt 关机
- reboot 重启
- sync 把内存的数据写入硬盘

不管是关机还是重启，都需要先执行sync，再执行关机或者重启

Linux默认在关机或者重启时，会先执行sync，再执行关机或者重启

## 第八章 用户登录与注销

### 登录

登录时，一般不使用root账号登录

可以利用普通用户登录，然后使用su命令切换到系统管理员身份

输入logout即可注销账号

logout指令在图形运行级别无效，在运行级别3中才有效

### 添加用户

useradd 用户名

当创建用户成功后，会自动地创建和用户同名的家目录

也可以通过 useradd -d 指定目录 来指定家目录

#### 指定和修改密码

passwd 用户名

输入两次密码，如果两次密码相同，则修改成功

#### 删除用户

需要在管理员权限下进行

userdel 用户名

#### 查询用户信息

id 用户名

#### 切换用户

su - 用户名

切换用户后，会进入到家目录中

从权限高的切换到权限低的，不需要输入密码

#### 查看当前用户

whoami

### 用户组

类似于角色，系统可以对有共性的多个用户进行统一管理

#### 新增组

groupadd 组名

#### 删除组

groupdel 组名

#### 新增用户到组中

useradd -g 组名 用户名

#### 修改用户的组

usermod -g 组名 用户名

#### /etc/passwd

用户的配置文件，记录用户的各种信息

每行的含义：用户名:密码:UID:GID:注释:家目录:登录shell

#### /etc/shadow

密码的配置文件，记录用户的密码信息

每行的含义：用户名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:过期时间:锁定状态

#### /etc/group

组的配置文件，记录组的各种信息

每行的含义：组名:密码:GID:用户列表

## 第九章 实用指令

### 运行级别指定

运行级别：

0：关闭系统
1：单用户模式（找回丢失密码）
2：多用户模式，但是没有网络
3：多用户状态，有网络
4：系统未使用保留给用户
5：图形界面模式
6：系统重启

其中，最常用的是运行级别3 和 5，也可以制定默认运行级别

实用指令：init 运行级别 来切换不同的运行级别

#### 找回root密码

不同版本有所区别，对于centos7

1. 启动系统的开机界面按 e，进入编辑模式
2. 进入单用户模式
3. ...

### 帮助指令

- man 命令或配置文件：获取详细帮助信息
- help 命令：获取shell内置命令的帮助信息

也可以网上搜索

### 文件目录类

- pwd：获取当前目录的绝对路径
- ls：列出当前目录下的文件 常用选项：-l 显示详细信息，-a 显示隐藏文件，-r 倒序排列，-t 按时间排序，-S 按大小排序，-h 显示带单位，-F 显示文件类型，-R 递归显示子目录
- cd：定位绝对路径或者相对路径 常用选项：cd .. 返回上一级目录，cd - 回到上一次目录，cd ~ 回到当前用户家目录
- mkdir：创建目录 常用选项：-p 创建多级目录
- rmdir：删除空目录
- rm -rf：强制删除目录，非常危险的行为
- cp 选项 source dest：常用选项：-r：复制整个目录
- \cp 选项 source dest：常用选项：-r：复制整个目录，强制覆盖
- touch：在当前文件夹下创建文件，常用选项：-a：修改访问时间，-m：修改修改时间，-t：指定时间，格式为：YYYYMMDDhhmm.ss
- rm 文件名：删除文件，常用选项：-f：强制删除，-i：交互式删除，-r：删除目录
- mv：移动文件，常用选项：-f：强制覆盖，-i：交互式覆盖，-u：不覆盖，-t：指定目标目录
- cat：查看文件内容，只能查看 cat 【选项】 -n：显示行号
- 管道命令：ls -l | grep .sh 将ls -l 的结果 pip 到 grep .sh
- more：一个基于VI编辑器的文本过滤器，以全屏幕的方式按页显示文本文件的内容。more中内置了命令。
- less：分屏产看文件内容，与more类似，但比more更强大，可以支持各种显示终端，less不是一次性加载文件的所有内容，而是根据需要，实时更新，对于显示大型文件更有效率
- echo：输出内容到控制台
- head：显示文件开头，默认显示文件前十行内容

### 文件操作

| 使用频率 | 指令 | 简述 | 常用选项 |
| --- | --- | --- | --- |
| 高 | ls | 列出目录内容 | -l, -a, -h, -t |
| 高 | cd | 切换目录 | 无 |
| 高 | cp | 复制文件或目录 | -r, -i, -a, -v |
| 高 | mv | 移动或重命名文件 | -i, -v, -u |
| 高 | rm | 删除文件或目录 | -r, -f, -i, -v |
| 中 | touch | 创建空文件或修改文件时间戳 | 无 |
| 中 | mkdir | 创建目录 | -p, -v |
| 中 | rmdir | 删除空目录 | -p, -v |
| 中 | chmod | 更改文件或目录的权限 | -R, -v, -f |
| 中 | chown | 更改文件或目录的所有者 | -R, -v, -f |
| 中 | chgrp | 更改文件或目录的所属组 | -R, -v, -f |

### 文本处理

| 使用频率 | 指令 | 简述 | 常用选项 |
| --- | --- | --- | --- |
| 高 | grep | 在文件中搜索文本 | -i, -v, -n, -w |
| 高 | cat | 查看文件内容 | -n, -b, -s, -T |
| 高 | less | 分页查看文件内容 | -i, -N, -G, -M |
| 高 | more | 分页查看文件内容 | 无 |
| 高 | tail | 查看文件末尾内容 | -n, -f, -q |
| 高 | head | 查看文件开头内容 | -n, -q |
| 中 | sed | 流编辑器，用于文本替换 | -e, -i, -n |
| 中 | awk | 文本处理工具，用于格式化文本 | -F, -v |
| 中 | sort | 对文件内容进行排序 | -r, -n, -u |
| 中 | uniq | 去除重复的行 | -i, -w, -s |
| 中 | wc | 统计文件的行数、单词数和字节数 | -l, -w, -c, -m |
| 中 | cut | 从文件每行中提取部分字段 | -d, -f, -c |
| 中 | paste | 将多个文件的列合并 | -d, -s |

### 系统管理

| 使用频率 | 指令 | 简述 | 常用选项 |
| --- | --- | --- | --- |
| 高 | sudo | 以超级用户权限执行命令 | -v, -k, -l, -s |
| 高 | apt | 软件包管理器（Debian/Ubuntu） | -y, -get, -remove, -update |
| 高 | yum | 软件包管理器（RHEL/CentOS） | -y, -install, -remove, -update |
| 高 | dnf | 软件包管理器（Fedora） | -y, -install, -remove, -update |
| 中 | df | 显示磁盘空间使用情况 | -h, -i, -T |
| 中 | du | 显示文件或目录磁盘使用情况 | -h, -s, -a, -c |
| 中 | mount | 挂载文件系统 | -t, -o, -v |
| 中 | umount | 卸载文件系统 | -l, -f, -v |
| 中 | find | 搜索不同路径下的文件 | -type, -name, -mtime, -exec |
| 中 | locate | 快速查找文件 | -i, -c, -b |
| 中 | which | 查找可执行文件的路径 | -a |
| 中 | whereis | 查找程序的可执行文件、源代码和手册页 | -b, -m |
| 中 | uptime | 显示系统运行时间 | 无 |
| 中 | free | 显示系统内存使用情况 | -h, -m, -s |
| 中 | top | 实时显示系统进程 | -b, -n, -s |
| 中 | htop | 交互式进程查看工具 | 无 |
| 中 | ps | 显示进程状态 | -aux, -ef, -www |
| 中 | kill | 终止进程 | -9, -15, -1, -2 |
| 中 | service | 管理系统服务 | start, stop, restart, status |
| 中 | systemctl | 系统单元管理工具 | start, stop, restart, status |
| 中 | journalctl | 查看系统日志 | -u, -b, -f, --since |
| 中 | useradd | 添加用户 | -m, -d, -s |
| 中 | userdel | 删除用户 | -r |
| 中 | passwd | 更改用户密码 | -e, -l, -u |
| 中 | su | 切换用户身份 | -l, -p |
| 中 | crontab | 定时任务管理 | -e, -l, -r |

### 网络操作

| 使用频率 | 指令 | 简述 | 常用选项 |
| --- | --- | --- | --- |
| 高 | ping | 测试网络连接 | -c, -s, -w |
| 高 | ssh | 远程登录到服务器 | -p, -i, -l |
| 高 | scp | 安全地复制文件到远程服务器 | -r, -p, -C |
| 中 | netstat | 显示网络连接、路由表等 | -t, -u, -n, -p |
| 中 | ss | 更快的网络连接查看工具 | -t, -u, -n, -p |
| 中 | ifconfig | 配置网络接口 | -a, -s |
| 中 | ip | 管理路由、网络设备等 | addr, link, route |
| 中 | wget | 从网络下载文件 | -O, -P, -q, -c |
| 中 | curl | 从服务器传输数据 | -O, -L, -H, -d |
| 中 | traceroute | 跟踪数据包的路由路径 | -n, -I, -U |
| 中 | nmap | 网络扫描工具 | -sP, -sS, -sV |
| 中 | iptables | 防火墙配置工具 | -L, -A, -D, -F |

### 其他

| 使用频率 | 指令 | 简述 | 常用选项 |
| --- | --- | --- | --- |
| 中 | man | 查看命令帮助文档 | -k, -f |
| 中 | info | 查看命令的详细信息 | 无 |
| 中 | help | 查看内置命令的帮助信息 | 无 |
| 中 | history | 查看历史命令 | -c, -w |
| 中 | alias | 创建命令别名 | 无 |
| 中 | unalias | 删除命令别名 | 无 |
| 中 | echo | 打印文本或变量值 | -n, -e |
| 中 | printf | 格式化输出文本 | 无 |
| 中 | tar | 归档和解压文件 | -c, -x, -v, -f, -z, -j, -J |
| 中 | gzip | 压缩文件 | -d, -k, -v |
| 中 | bzip2 | 压缩文件 | -d, -k, -v |
| 中 | **xz** | 压缩文件 | -d, -k, -v |
| 中 | **zip** | 压缩文件 | -r, -d, -q |
| 中 | **unzip** | 解压文件 | -l, -t, -o |
| 中 | date | 显示或设置系统日期和时间 | -u, -d, -s |
| 中 | cal | 显示日历 | -m, -y |
| 中 | uptime | 显示系统运行时间 | 无 |
| 中 | uname | 显示系统信息 | -a, -s, -r, -m |
| 中 | hostname | 显示或设置系统主机名 | -i, -d, -f |
| 中 | who | 显示当前登录的用户 | -a, -H |
| 中 | w | 显示系统用户和系统信息 | 无 |
| 中 | id | 显示用户的UID和GID | -u, -g, -n |
| 中 | which | 查找可执行文件的路径 | -a |
| 中 | whereis | 查找程序的可执行文件、源代码和手册页 | -b, -m |
| 中 | locate | 快速查找文件 | -i, -c, -b |
| 中 | file | 查看文件类型 | -i, -z, -m |
| 中 | diff | 比较文件差异 | -u, -c, -w |
| 中 | comm | 比较两个排序文件的公共行和差异行 | -1, -2, -3 |
| 中 | cmp | 比较两个文件 | -l, -s |
| 中 | cmp | 比较两个文件 | -l, -s |
| 中 | xargs | 构造命令行并执行 | -n, -I, -0 |
| 中 | tee | 读取标准输入并将其写入标准输出和文件 | -a, -i |
| 中 | base64 | 对文件进行base64编码或解码 | -w, -d, -i |

## 第十章 组管理和权限管理

Linux下的文件权限管理有以下信息：

1. 所有者
2. 所在组
3. 其他组
4. 改变用户所在的组

Linux中，每一个用户都有所在的组

对于文件来说，他先看文件的创建者是谁，然后再看创建者所在的组，创建者和其组内的其他用户都有一定的权限

### 文件/目录所有者

### 其他组

除文件所有者和所在组外的其他用户，被称为其他组

### rwx权限

ls -l 指令下，有

`-rw-r--r--. 1 tom root 105 Aug 26 09:05 tom.txt`

0-9位说明

1. 第0位确定文件类型
   1. i链接
   2. d目录
   3. c字符设备文件
   4. b块设备文件
2. 第1-3位确定所有者（该文件的所有者）拥有该文件的权限
3. 第4-6位确定所在组（该文件所在的组）拥有该文件的权限
4. 第7-9位确定其他组（除所有者和所在组外的其他用户）拥有该文件的权限

- r 读
- w 写
- x 执行
- - 无权限

同时**也可以用数字表示权限**

r = 4， w = 2， x = 1

其他说明

- 1 文件：硬连接数或目录：子目录数
- tom 用户
- root 所在组
- 105 文件大小
- Aug 26 09:05 文件创建时间
- tom.txt 文件名

### 文件/目录权限修改

rwx作用到文件

- r可以读取、查看
- w可以修改，但是不代表可以删除，删除一个文件的前提是对该文件所在目录有写入权限
- x可以执行

rwx作用到目录

- r可以读取，ls查看目录内容
- w可以修改，对目录内创建 + 删除 + 重命名目录
- x可以执行，cd进入目录

### chmod详解

通过chmod命令可以修改文件的权限

使用 + - = 来修改权限

u:所有者 g:所在组 o:其他组 a:所有用户

1. chmod g+x tom.txt
2. chmod g-x tom.txt
3. chmod u=rwx tom.txt

### chown/chgrp详解

chown newowner:newgroup file

chgrp newgroup file

## 第十一章 定时任务调度

### crond 任务调度

使用`crond`命令来查看定时任务

使用`crontab`进行 定时任务管理

或者定时调用脚本或指令

常用选项：

- -e 编辑定时任务
- -l 查看定时任务
- -r 删除当前用户的所有定时任务

参数设置细节：

如`*/1**** ls -l /etc/ > /tmp/to.txt`

其中的`*`

1. 一小时中的第几分钟 - 0-59
2. 一天中的第几个小时 - 0-23
3. 一个月当中的第几天 - 1-31
4. 一年当中的第几个月 - 1-12
5. 一周中的星期几 - 0-7

![特殊字符](./img/屏幕截图%202025-04-25%20160932.png)

### at 定时任务

`at [选项] [时间]`

使用 Crtl + D 退出at命令的输入

## 第十二章 Linux分区与磁盘挂载

1. 对Linux来说，无论有几个分区，它归根到底只有一个根目录，一个唯一且独立的文件结构，Linux中每个分区都是用来组成整个文件系统的一部分。
2. Linux使用了一种叫载入的处理方法，它的整个文件系统中包含了一整套的文件和目录，且将一个分区和一个目录相联系。这时要载入的一个分区将使他的存储空间在一个目录获得。
