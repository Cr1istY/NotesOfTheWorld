# Linux

## 第三章 Linux基础篇 - VM和Linux安装

### 1. 网络连接的三种模式

#### 1. 桥接模式

虚拟系统可以和外部系统相互通信，但是主机数量有限

当主机过多时，ip会产生冲突

#### 2. NAT模式

网络地址转换模式

虚拟机同主机互通，再通过主机进行外部通讯

可以避免ip冲突

#### 3. 仅主机模式

独立系统，不和外部发生联系

### 2. 其他操作

#### 1. 虚拟机迁移和删除

#### 2. 虚拟机克隆

如果需要虚拟机集群时，不需要重新安装虚拟机，只需要进行克隆即可

1. 直接拷贝一份安装好的虚拟机文件，然后修改虚拟机名称和ip地址即可
2. 使用VmWare的虚拟机克隆功能

#### 3. 虚拟机快照

所谓的快照管理，就是将虚拟机恢复到以前的状态

### 3. vmtools

使用 vmtools 来设置共享文件夹

但是在实际开发中，文件的上传和下载需要通过远程环境来完成

## 第四章 Linux目录结构

linux的文件系统，采用层级分明的树状结构，在此结构的最上方是根目录`/`

**Linux中，一切皆文件。**

在Windows中，目录的规定大多时候不是很严格

但是，Linux中，目录的的规定严格很多

Linux中的目录，大多都是规定好的

Linux会把硬件映射成文件进行管理

### Linux目录结构

需要有印象

跟系统相关的文件夹不建议更改

- /bin 常用，这个目录存放着最常用的命令
- /sbin 存放系统管理员的系统管理程序
- /home 常用 存放普通用户的主目录，而Linux中，每个用户都有自己的一个文件夹
- /root 常用 该目录为系统管理员，即root用户的主目录
- /lib 系统开机所需要用到的最基本的动态连接共享库
- /lost + found 一般为空，当系统非法关机后，这里会自动生成文件
- /etc 常用 存放配置文件，如主机名、网络配置、系统参数等
- /usr 常用 存放用户软件，如命令行工具、图形界面工具、文档、帮助文件等
- **/boot** 常用 存放启动时需要的文件，如内核、引导程序等
- /proc 虚拟文件系统，存放系统进程信息，如内存使用情况、网络连接情况、文件系统信息等
- /src 存放一些服务启动之后才需要提取的文件
- /sys Linux2.6内核的一个很大变化，有2.6内核才有的文件系统sysfs
- /tmp 存放临时文件，如shell脚本生成的临时文件等
- /dev 存放设备文件，如键盘、鼠标、打印机、磁盘、网卡等
- /media 存放 removable media，如U盘、光驱等可移动设备
- /mnt 挂载点，用于挂载文件系统，如/dev/hda1挂载到/mnt/hda1中
- /opt 给主机额外安装软件所存放的目录，尽量把些第三方软件安装到这个目录下
- /usr/local 存放用户安装的第三方软件的源码，如apache、mysql、php等
- /var 常用 存放一些动态变化的数据，如日志文件、数据库文件、邮件文件等
- /selinux 保证系统安全，可自行设置

需要记住目录树

## 第五章 Linux实操篇

### 远程登录到Linux

使用 Xshell 进行远程登录

使用 Xftp 进行文件的上传和下载

## 第六章 Vim与Vi

### vi和vim

Linux中，vim和vi是两种不同的编辑器

vi就是记事本

Vim具有程序编辑的能力，是vi的增强版

### 常用的三种模式

- 正常模式：以 vim 打开一个文档时，就进入了正常模式，在这个模式下，可以使用方向键来移动行数，也可以对文档进行删除，或者复制粘贴
- 插入模式：在正常模式下，按下 i 或者 a 或者 o，就可以进入插入模式，在这个模式下，就可以输入内容，并且可以进行删除，复制粘贴等操作
- 命令行模式：在正常模式下，按下 : ，就可以进入命令行模式，在这个模式下，就可以进行一些命令的输入，比如退出 vim，保存文件等

### 各种模式的切换

- 快捷键使用练习：

1. 拷贝当前行 yy， 拷贝当前行向下的 3 行 3yy，然后粘贴到当前行下面 p
2. 删除当前行 dd， 删除当前行向下的 3 行 3dd
3. 在文件中查找某个单词 命令行下 /关键字 ，回车查找， 输入 n 就是查找下一个
4. 设置文件行号，取消文件的行号 :set nu 和 :set nonu
5. 定位到最末行和最受行，G 和 gg
6. 撤销动作 u
7. 光标移动 20行 shift + j

## 第七章 Linux登陆、关机与重启

### 关机

- shutdown -h now 立刻关机
- shutdown -h 10:00 关闭，10点关闭
- shutdown -r now 立刻重启
- shutdown 默认为 -h 1，关机，1表示1分钟后关机
- halt 关机
- reboot 重启
- sync 把内存的数据写入硬盘

不管是关机还是重启，都需要先执行sync，再执行关机或者重启

Linux默认在关机或者重启时，会先执行sync，再执行关机或者重启

## 第八章 用户登录与注销

### 登录

登录时，一般不使用root账号登录

可以利用普通用户登录，然后使用su命令切换到系统管理员身份

输入logout即可注销账号

logout指令在图形运行级别无效，在运行级别3中才有效

### 添加用户

useradd 用户名

当创建用户成功后，会自动地创建和用户同名的家目录

也可以通过 useradd -d 指定目录 来指定家目录

#### 指定和修改密码

passwd 用户名

输入两次密码，如果两次密码相同，则修改成功

#### 删除用户

需要在管理员权限下进行

userdel 用户名

#### 查询用户信息

id 用户名

#### 切换用户

su - 用户名

切换用户后，会进入到家目录中

从权限高的切换到权限低的，不需要输入密码

#### 查看当前用户

whoami

### 用户组

类似于角色，系统可以对有共性的多个用户进行统一管理

#### 新增组

groupadd 组名

#### 删除组

groupdel 组名

#### 新增用户到组中

useradd -g 组名 用户名

#### 修改用户的组

usermod -g 组名 用户名

#### /etc/passwd

用户的配置文件，记录用户的各种信息

每行的含义：用户名:密码:UID:GID:注释:家目录:登录shell

#### /etc/shadow

密码的配置文件，记录用户的密码信息

每行的含义：用户名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:过期时间:锁定状态

#### /etc/group

组的配置文件，记录组的各种信息

每行的含义：组名:密码:GID:用户列表

## 第九章 实用指令

### 运行级别指定

运行级别：

0：关闭系统
1：单用户模式（找回丢失密码）
2：多用户模式，但是没有网络
3：多用户状态，有网络
4：系统未使用保留给用户
5：图形界面模式
6：系统重启

其中，最常用的是运行级别3 和 5，也可以制定默认运行级别

实用指令：init 运行级别 来切换不同的运行级别

#### 找回root密码

不同版本有所区别，对于centos7

1. 启动系统的开机界面按 e，进入编辑模式
2. 进入单用户模式
3. ...

### 帮助指令

- man 命令或配置文件：获取详细帮助信息
- help 命令：获取shell内置命令的帮助信息

也可以网上搜索

### 文件目录类

- pwd：获取当前目录的绝对路径
- ls：列出当前目录下的文件 常用选项：-l 显示详细信息，-a 显示隐藏文件，-r 倒序排列，-t 按时间排序，-S 按大小排序，-h 显示带单位，-F 显示文件类型，-R 递归显示子目录
- cd：定位绝对路径或者相对路径 常用选项：cd .. 返回上一级目录，cd - 回到上一次目录，cd ~ 回到当前用户家目录
- mkdir：创建目录 常用选项：-p 创建多级目录
- rmdir：删除空目录
- rm -rf：强制删除目录，非常危险的行为
- cp 选项 source dest：常用选项：-r：复制整个目录
- \cp 选项 source dest：常用选项：-r：复制整个目录，强制覆盖
- touch：在当前文件夹下创建文件，常用选项：-a：修改访问时间，-m：修改修改时间，-t：指定时间，格式为：YYYYMMDDhhmm.ss
- rm 文件名：删除文件，常用选项：-f：强制删除，-i：交互式删除，-r：删除目录
- mv：移动文件，常用选项：-f：强制覆盖，-i：交互式覆盖，-u：不覆盖，-t：指定目标目录
- cat：查看文件内容，只能查看 cat 【选项】 -n：显示行号
- 管道命令：ls -l | grep .sh 将ls -l 的结果 pip 到 grep .sh
- more：一个基于VI编辑器的文本过滤器，以全屏幕的方式按页显示文本文件的内容。more中内置了命令。
- less：分屏产看文件内容，与more类似，但比more更强大，可以支持各种显示终端，less不是一次性加载文件的所有内容，而是根据需要，实时更新，对于显示大型文件更有效率
- echo：输出内容到控制台
- head：显示文件开头，默认显示文件前十行内容
